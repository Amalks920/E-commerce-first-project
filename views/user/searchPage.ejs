<% console.log("categories") %>
	<% console.log(categories) %>
		<% console.log("categories") %>
			<!-- top Products -->
			<div class="ads-grid_shop">
				<div class="shop_inner_inf">
					<!-- tittle heading -->

					<!-- //tittle heading -->
					<!-- product left -->
					<div class="side-bar col-md-3">
						<div class="search-hotel">
							<h3 class="agileits-sear-head">Search Here..</h3>
							<form action="#" method="post">
								<input id="search" type="search" value="<%=searchInput -%>" placeholder="Product name..." name="search"
									required="">
								<input id="search-submit" type="submit" value=" ">
							</form>
						</div>
						<!-- price range -->
						<div class="range">
							<h3 class="agileits-sear-head">Price range</h3>
							<ul class="dropdown-menu6">
								<li>

									<div id="slider-range"></div>
									<input type="text" id="amount"
										style="border: 0; color: #ffffff; font-weight: normal;" />
								</li>
							</ul>
						</div>
						<!-- //price range -->
						<!--preference -->
						<div class="left-side">
							<h3 class="agileits-sear-head">Category</h3>
							<ul>
								<li>
									<input id="category-filter" type="checkbox" value="men" class="checked" <% if
										(categories.includes('men')) { %> checked <% } %>>

										<span class="span">Men</span>
								</li>
								<li>
									<input id="category-filter" type="checkbox" value="women" class="checked" <% if
										(categories.includes('women')) { %> checked <% } %>>
										<span class="span">Women</span>
								</li>
								<li>
									<input id="category-filter" type="checkbox" value="kids" class="checked" <% if
										(categories.includes('kids')) { %> checked <% } %>>
										<span class="span">Kids</span>
								</li>
								<li><button id="filter">Filter</button></li>
							</ul>
						</div>
						<!-- // preference -->
						<!-- discounts -->
						<div class="left-side">
							<h3 class="agileits-sear-head">Price Range</h3>
							<ul>
								<li>
									<input id="low-to-high" type="radio" value="1" name="price-order" class="checked"
										onchange="handleRadioChange(this)">
									<label for="low-to-high" class="span">Low to High</label>
								</li>
								<li>
									<input id="high-to-low" type="radio" value="2" name="price-order" class="checked"
										onchange="handleRadioChange(this)">
									<label for="high-to-low" class="span">High to Low</label>
								</li>
							</ul>
						</div>
						<!-- //discounts -->
						<!-- reviews -->
						<div class="customer-rev left-side">
							<h3 class="agileits-sear-head">Customer Review</h3>
							<ul>
								<li>
									<a href="#">
										<i class="fa fa-star" aria-hidden="true"></i>
										<i class="fa fa-star" aria-hidden="true"></i>
										<i class="fa fa-star" aria-hidden="true"></i>
										<i class="fa fa-star" aria-hidden="true"></i>
										<i class="fa fa-star" aria-hidden="true"></i>
										<span>5.0</span>
									</a>
								</li>
								<li>
									<a href="#">
										<i class="fa fa-star" aria-hidden="true"></i>
										<i class="fa fa-star" aria-hidden="true"></i>
										<i class="fa fa-star" aria-hidden="true"></i>
										<i class="fa fa-star" aria-hidden="true"></i>
										<i class="fa fa-star-o" aria-hidden="true"></i>
										<span>4.0</span>
									</a>
								</li>
								<li>
									<a href="#">
										<i class="fa fa-star" aria-hidden="true"></i>
										<i class="fa fa-star" aria-hidden="true"></i>
										<i class="fa fa-star" aria-hidden="true"></i>
										<i class="fa fa-star-half-o" aria-hidden="true"></i>
										<i class="fa fa-star-o" aria-hidden="true"></i>
										<span>3.5</span>
									</a>
								</li>
								<li>
									<a href="#">
										<i class="fa fa-star" aria-hidden="true"></i>
										<i class="fa fa-star" aria-hidden="true"></i>
										<i class="fa fa-star" aria-hidden="true"></i>
										<i class="fa fa-star-o" aria-hidden="true"></i>
										<i class="fa fa-star-o" aria-hidden="true"></i>
										<span>3.0</span>
									</a>
								</li>
								<li>
									<a href="#">
										<i class="fa fa-star" aria-hidden="true"></i>
										<i class="fa fa-star" aria-hidden="true"></i>
										<i class="fa fa-star-half-o" aria-hidden="true"></i>
										<i class="fa fa-star-o" aria-hidden="true"></i>
										<i class="fa fa-star-o" aria-hidden="true"></i>
										<span>2.5</span>
									</a>
								</li>
							</ul>
						</div>
						<!-- //reviews -->
						<!-- deals -->
						<div class="deal-leftmk left-side">
							<h3 class="agileits-sear-head">Special Deals</h3>
							<div class="special-sec1">
								<div class="col-xs-4 img-deals">
									<img src="images/s4.jpg" alt="">
								</div>
								<div class="col-xs-8 img-deal1">
									<h3>Shuberry Heels</h3>
									<a href="single.html">$180.00</a>
								</div>
								<div class="clearfix"></div>
							</div>
							<div class="special-sec1">
								<div class="col-xs-4 img-deals">
									<img src="images/s2.jpg" alt="">
								</div>
								<div class="col-xs-8 img-deal1">
									<h3>Chikku Loafers</h3>
									<a href="single.html">$99.00</a>
								</div>
								<div class="clearfix"></div>
							</div>
							<div class="special-sec1">
								<div class="col-xs-4 img-deals">
									<img src="images/s1.jpg" alt="">
								</div>
								<div class="col-xs-8 img-deal1">
									<h3>Bella Toes</h3>
									<a href="single.html">$165.00</a>
								</div>
								<div class="clearfix"></div>
							</div>
							<div class="special-sec1">
								<div class="col-xs-4 img-deals">
									<img src="images/s5.jpg" alt="">
								</div>
								<div class="col-xs-8 img-deal1">
									<h3>Red Bellies</h3>
									<a href="single.html">$225.00</a>
								</div>
								<div class="clearfix"></div>
							</div>
							<div class="special-sec1">
								<div class="col-xs-4 img-deals">
									<img src="images/s3.jpg" alt="">
								</div>
								<div class="col-xs-8 img-deal1">
									<h3>(SRV) Sneakers</h3>
									<a href="single.html">$169.00</a>
								</div>
								<div class="clearfix"></div>
							</div>
						</div>
						<!-- //deals -->

					</div>
					<!-- //product left -->
					<!-- product right -->
					<div class="left-ads-display col-md-9">
						<div class="wrapper_top_shop">
							<div class="col-md-6 shop_left">
								<img src="images/banner3.jpg" alt="">
								<h6>40% off</h6>
							</div>
							<div class="col-md-6 shop_right">
								<img src="images/banner2.jpg" alt="">
								<h6>50% off</h6>
							</div>
							<div class="clearfix"></div>
							<!-- product-sec1 -->
							<div class="product-sec1">
								<!--/mens-->
								<% products.forEach((items)=>{ %>


									<div class="col-md-4 product-men">
										<div class="product-shoe-info shoe">
											<div class="men-pro-item">
												<div class="men-thumb-item">
													<img src="/images/uploads/<%= items?.images[0] %>" alt="">
													<div class="men-cart-pro">
														<div class="inner-men-cart-pro">
															<a href="/product-page/<%= items?._id %>"
																class="link-product-add-cart">Quick View</a>
														</div>
													</div>
													<span class="product-new-top">New</span>
												</div>
												<div class="item-info-product">
													<h4>
														<a href="single.html">
															<%= items?.productname %>
														</a>
													</h4>
													<div class="info-product-price">
														<div class="grid_meta">
															<div class="product_price">
																<div class="grid-price ">
																	<span class="money ">
																		<%= items?.price %>
																	</span>
																</div>
																<% if(items?.stock===0){ %>
																	<h2 style="color: red;position: absolute;left: 100px;">Out of Stock</h2>
																<% } %>
															</div>
															<ul class="stars" >
																<li><a href="#"><i class="fa fa-star"
																			aria-hidden="true"></i></a></li>
																<li><a href="#"><i class="fa fa-star"
																			aria-hidden="true"></i></a></li>
																<li><a href="#"><i class="fa fa-star"
																			aria-hidden="true"></i></a></li>
																<li><a href="#"><i class="fa fa-star-half-o"
																			aria-hidden="true"></i></a></li>
																<li><a href="#"><i class="fa fa-star-o"
																			aria-hidden="true"></i></a></li>
															</ul>
														</div>
														<div class="shoe single-item hvr-outline-out">
															<form action="#" method="post">
																<input type="hidden" name="cmd" value="_cart">
																<input type="hidden" name="add" value="1">
																<input type="hidden" name="shoe_item"
																	value="Bella Toes">
																<input type="hidden" name="amount" value="675.00">
																<button type="submit" class="shoe-cart pshoe-cart"><i
																		class="fa fa-cart-plus"
																		aria-hidden="true"></i></button>

																<a href="#" data-toggle="modal"
																	data-target="#myModal1"></a>
															</form>

														</div>
													</div>
													<div class="clearfix"></div>
												</div>
											</div>
										</div>
									</div>

									<% }) %>




										<!-- //mens -->
										<div class="clearfix"></div>

							</div>

							<!-- //product-sec1 -->
							<div class="col-md-6 shop_left shp">
								<img src="/images/banner4.jpg" alt="">
								<h6>21% off</h6>
							</div>
							<div class="col-md-6 shop_right shp">
								<img src="/images/banner1.jpg" alt="">
								<h6>31% off</h6>
							</div>
							<div class="clearfix"></div>
						</div>
					</div>
					<div class="clearfix"></div>
				</div>
			</div>
			<!-- //top products -->
			<div class="mid_slider_w3lsagile">
				<div class="col-md-3 mid_slider_text">
					<h5>Some More Shoes</h5>
				</div>
				<div class="col-md-9 mid_slider_info">
					<div id="myCarousel" class="carousel slide" data-ride="carousel">
						<!-- Indicators -->
						<ol class="carousel-indicators">
							<li data-target="#myCarousel" data-slide-to="0" class=""></li>
							<li data-target="#myCarousel" data-slide-to="1" class="active"></li>
							<li data-target="#myCarousel" data-slide-to="2" class=""></li>
							<li data-target="#myCarousel" data-slide-to="3" class=""></li>
						</ol>
						<div class="carousel-inner" role="listbox">
							<div class="item">
								<div class="row">
									<div class="col-md-3 col-sm-3 col-xs-3 slidering">
										<div class="thumbnail"><img src="/images/g1.jpg" alt="Image"
												style="max-width:100%;"></div>
									</div>

									<div class="col-md-3 col-sm-3 col-xs-3 slidering">
										<div class="thumbnail"><img src="/images/g2.jpg" alt="Image"
												style="max-width:100%;"></div>
									</div>
									<div class="col-md-3 col-sm-3 col-xs-3 slidering">
										<div class="thumbnail"><img src="/images/g3.jpg" alt="Image"
												style="max-width:100%;"></div>
									</div>
									<div class="col-md-3 col-sm-3 col-xs-3 slidering">
										<div class="thumbnail"><img src="/images/g4.jpg" alt="Image"
												style="max-width:100%;"></div>
									</div>

								</div>
							</div>
							<div class="item active">
								<div class="row">
									<div class="col-md-3 col-sm-3 col-xs-3 slidering">
										<div class="thumbnail"><img src="/images/g5.jpg" alt="Image"
												style="max-width:100%;"></div>
									</div>
									<div class="col-md-3 col-sm-3 col-xs-3 slidering">
										<div class="thumbnail"><img src="/images/g6.jpg" alt="Image"
												style="max-width:100%;"></div>
									</div>
									<div class="col-md-3 col-sm-3 col-xs-3 slidering">
										<div class="thumbnail"><img src="/images/g2.jpg" alt="Image"
												style="max-width:100%;"></div>
									</div>
									<div class="col-md-3 col-sm-3 col-xs-3 slidering">
										<div class="thumbnail"><img src="/images/g1.jpg" alt="Image"
												style="max-width:100%;"></div>
									</div>
								</div>
							</div>
							<div class="item">
								<div class="row">
									<div class="col-md-3 col-sm-3 col-xs-3 slidering">
										<div class="thumbnail"><img src="/images/g1.jpg" alt="Image"
												style="max-width:100%;"></div>
									</div>
									<div class="col-md-3 col-sm-3 col-xs-3 slidering">
										<div class="thumbnail"><img src="/images/g2.jpg" alt="Image"
												style="max-width:100%;"></div>
									</div>
									<div class="col-md-3 col-sm-3 col-xs-3 slidering">
										<div class="thumbnail"><img src="/images/g3.jpg" alt="Image"
												style="max-width:100%;"></div>
									</div>
									<div class="col-md-3 col-sm-3 col-xs-3 slidering">
										<div class="thumbnail"><img src="/images/g4.jpg" alt="Image"
												style="max-width:100%;"></div>
									</div>
								</div>
							</div>
							<div class="item">
								<div class="row">
									<div class="col-md-3 col-sm-3 col-xs-3 slidering">
										<div class="thumbnail"><img src="/images/g1.jpg" alt="Image"
												style="max-width:100%;"></div>
									</div>
									<div class="col-md-3 col-sm-3 col-xs-3 slidering">
										<div class="thumbnail"><img src="/images/g2.jpg" alt="Image"
												style="max-width:100%;"></div>
									</div>
									<div class="col-md-3 col-sm-3 col-xs-3 slidering">
										<div class="thumbnail"><img src="/images/g3.jpg" alt="Image"
												style="max-width:100%;"></div>
									</div>
									<div class="col-md-3 col-sm-3 col-xs-3 slidering">
										<div class="thumbnail"><img src="/images/g4.jpg" alt="Image"
												style="max-width:100%;"></div>
									</div>
								</div>
							</div>
						</div>
						<a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
							<span class="fa fa-chevron-left" aria-hidden="true"></span>
							<span class="sr-only">Previous</span>
						</a>
						<a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
							<span class="fa fa-chevron-right" aria-hidden="true"></span>
							<span class="sr-only">Next</span>
						</a>
						<!-- The Modal -->

					</div>
				</div>

				<div class="clearfix"> </div>
			</div>
			<!-- /newsletter-->
			<div class="newsletter_w3layouts_agile">
				<div class="col-sm-6 newsleft">
					<h3>Sign up for Newsletter !</h3>
				</div>
				<div class="col-sm-6 newsright">
					<form action="#" method="post">
						<input type="email" placeholder="Enter your email..." name="email" required="">
						<input type="submit" value="Submit">
					</form>
				</div>

				<div class="clearfix"></div>
			</div>
			<!-- //newsletter-->

			</div>

			<script>
				const categoryFilterBtn = document.querySelector('#filter');
				const searchInputElement = document.querySelector('#search');

				//handle search
				console.log(searchInputElement)
				searchInputElement.addEventListener('input', function () {
					handleSearch(searchInputElement?.value)
				})

				let checkedValues = []
				function updateCheckedValues() {

					checkedValues.length = 0;
					const categoryFilter = document.querySelectorAll('#category-filter')

					categoryFilter.forEach((categoryFilterInput, index) => {
						if (categoryFilterInput.checked) {


							checkedValues.push(categoryFilterInput.value)
						}
					})

					// filter(checkedValues)
				}

				categoryFilterBtn.addEventListener('click', function () {
					window.location.href = `?category=${checkedValues}`
				})


				const checkboxes = document.querySelectorAll('#category-filter')

				checkboxes.forEach((checkbox, index) => {
					checkbox.addEventListener('change', updateCheckedValues)
				})


				function filter(checkedValues) {
					return window.location.href = `?category=${categoryFilterInput.value}`
					// 		fetch(`/search-page/${checkedValues}`, {
					//   method: "GET",
					//   headers: {
					//     "Content-Type": "application/json",
					//   },
					//   body: JSON.stringify({ checkedValues }),
					//  })
					//   .then((response) =>{
					//     location.reload(true)
					// 	response.json()
					//   })
					//   .then((data) => {

					//   })
					//   .catch((error) => console.error(error));
				}



				function handleRadioChange(input) {

					const currentURL = window.location.href;
					const urlObject = new URL(currentURL);

					const separator = currentURL.includes('?') ? '&' : '?';

				

					if (input.value == 1) {
						const newURL = `${currentURL}${separator}sort=lowtohigh`;
						window.location.href = newURL;
					} else {
						const newURL = `${currentURL}${separator}sort=hightolow`;
						window.location.href = newURL;
					}
				}

				function handleSearch(searchInput) {
					const currentURL = window.location.href;
					const urlObject = new URL(currentURL);

					if (urlObject.searchParams.has('search')) {
                       // Update the value of the existing 'search' query parameter
                       urlObject.searchParams.set('search', searchInput);
                     } else {
                       // Add the 'search' query parameter if it doesn't exist
                       urlObject.searchParams.append('search', searchInput);
                     }
					// const separator = currentURL.includes('?') ? '&' : '?';
					window.history.replaceState({}, '', urlObject.toString());
						// const newURL = `${currentURL}${separator}search=${searchInput}`;
						// window.location.href = newURL;
						location.reload(true)
					
				}
			</script>